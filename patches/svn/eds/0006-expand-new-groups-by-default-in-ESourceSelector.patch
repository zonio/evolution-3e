From 631a7371614158e7813eff70c2f1e044ea55eb32 Mon Sep 17 00:00:00 2001
From: Ondrej Jirman <ondrej.jirman@zonio.net>
Date: Sat, 23 Jun 2007 13:58:04 +0200
Subject: [PATCH] expand new groups by default in ESourceSelector

---
 libedataserverui/e-source-selector.c |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

diff --git a/libedataserverui/e-source-selector.c b/libedataserverui/e-source-selector.c
index c69509e..a3d0962 100644
--- a/libedataserverui/e-source-selector.c
+++ b/libedataserverui/e-source-selector.c
@@ -317,11 +317,14 @@ rebuild_model (ESourceSelector *selector)
 		GSList *sources, *q;
 		GtkTreeRowReference *row_ref;
 		gint position;
+		GtkTreePath *path_expand = NULL;
 
 		row_ref = g_hash_table_lookup (rebuild_data->remaining_uids, e_source_group_peek_uid (group));
 		if (!row_ref) {
+
 			gtk_tree_store_append (GTK_TREE_STORE (tree_store), &iter, NULL);
 			gtk_tree_store_set (GTK_TREE_STORE (tree_store), &iter, 0, group, -1);
+			path_expand = gtk_tree_model_get_path (GTK_TREE_MODEL (tree_store), &iter);
 		} else {
 			GtkTreePath *path;
 
@@ -361,6 +364,11 @@ rebuild_model (ESourceSelector *selector)
 
 		if (sources)
 			g_slist_free (sources);
+
+		if (path_expand) {
+			gtk_tree_view_expand_row (GTK_TREE_VIEW (selector), path_expand, TRUE);
+			gtk_tree_path_free (path_expand);
+		}
 	}
 
 	if (rebuild_data->selection_changed)
-- 
1.5.3.5.474-dirty

